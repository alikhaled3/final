(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5735,8939],{31133:e=>{function t(e){return Promise.resolve().then(()=>{var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=()=>[],t.resolve=t,t.id=31133,e.exports=t},7174:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/App/tables",function(){return a(37938)}])},55281:(e,t,a)=>{"use strict";a.r(t),a.d(t,{convert:()=>p,exportAllPagesToList:()=>m,exportHtmlToPdf:()=>u,exportHtmlToWord:()=>d,exportLatex:()=>g,exportTables:()=>b,splitPagesToHtml:()=>h});var n=a(18149),s=a(4213),l=a(42501);a(21605);var r=a(3959);let o=e=>{let t=atob(e),a=t.length,n=new Uint8Array(a);for(let e=0;e<a;e++)n[e]=t.charCodeAt(e);return n},c=e=>btoa(unescape(encodeURIComponent(e))),i=e=>{let t="<html><head><style>\n        .borderless td {border: 0px;}\n        .border td {border: 1px solid black;}\n    </style></head>";return Object.values(e).forEach(e=>{var a;let n=(null===(a=e.html.match(/<body[^>]*>[\s\S]*<\/body>/g))||void 0===a?void 0:a.at(0))||e.html;t+=n,t+='<div class="page-break" style="page-break-after: always;"></div>',t=(t=(t=(t=(t=(t=t.replace(/<ol type="1">/g,'<ol style="list-style-type:decimal;">')).replace(/<ol type="A">/g,'<ol style="list-style-type:upper-alpha;">')).replace(/<ol type="a">/g,'<ol style="list-style-type:lower-alpha;">')).replace(/<img[^>]*\/>/g,"")).replaceAll(RegExp('<table +class=\\"borderless\\">.*?<\\/table>',"gs"),e=>{let t=e;return(t=(t=t.replace(/<tr>/g,'<tr style="border:0px;">')).replace(/<td>/g,'<td style="border:0px;">')).replace(/<table +class="borderless">/g,'<table style="border:0px solid white;">')})).replaceAll(RegExp('<table +class=\\"border\\">.*?<\\/table>',"gs"),e=>{let t=e;return(t=(t=t.replace(/<tr>/g,'<tr style="border:1px;">')).replace(/<td>/g,'<td style="border:1px;">')).replace(/<table +class="border">/g,'<table style="border:1px solid black;">')})}),t+="</html>"};async function d(e){let t=i(e);console.log("Converting HTML: ",t);let a=await (0,n.A)(t);return(0,s.saveAs)(a,"Pen2Print-Export.docx"),!0}let p=async(e,t,a)=>{console.log("convert ".concat(t," to ").concat(e));let n=new Blob([a],{type:"text/plain"});return fetch("https://nmwe4beyw1.execute-api.us-east-1.amazonaws.com/dev/generate/convert",{method:"POST",body:JSON.stringify({to:e,from:t,data:c(a),hash:await (0,l.w)(n)}),headers:{"Content-Type":"application/json"}}).then(e=>{if(console.log("convertiong responsed"),200!==e.status)throw Error("HTTP error, status = "+e.status);return e.json()}).then(e=>({status:!0,bytes:o(e.data)})).catch(e=>(console.log("convert error",e),{status:!1,error:e}))};async function g(e,t){let a=Object.values(e).map(e=>e.html.replace(RegExp("\\\\documentclass{article}.*\\\\begin{document}(.*)\\\\end{document}","gs"),(e,t)=>t)).join("\n\\newpage\n"),n="\\documentclass{article}\n\\usepackage{amsmath}\n\\usepackage{amsfonts}\n\\usepackage{amssymb}\n\\begin{document}".concat(a,"\n\\end{document}");switch(t){case"WORD":{let{status:e,bytes:t,error:a}=await p("docx","latex",n);if(!e)return console.log("Error converting to Word"),!1;let l=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});(0,s.saveAs)(l,"Pen2Print-Export.docx");break}case"PDF":{let{status:e,bytes:t,error:a}=await p("pdf","latex",n);if(!e)return console.log("Error converting to PDF"),!1;let l=new Blob([t],{type:"application/pdf"});(0,s.saveAs)(l,"Pen2Print-Export.pdf");break}case"LATEX":(0,s.saveAs)(new Blob([n],{type:"text/plain"}),"Pen2Print-Export.tex")}return!0}async function u(e){return i(e),!0}let m=e=>Object.values(e).map(e=>{let t=e.tableData,a=[];return t.forEach(e=>{"P"===e.type&&a.push([e.content]),"KV"===e.type&&a.push([e.key,e.value]),"T"===e.type&&e.content.forEach(e=>{a.push(e)})}),a}),h=e=>{let t=e.reduce((e,t)=>Math.max(e,t.reduce((e,t)=>Math.max(e,t.length),0)),0);return e.map(e=>{let a=e.map(e=>{if(1===e.length)return'<tr><td class="tablePreviewParagraph" colspan="'.concat(t,'">').concat(e[0],"</td></tr>");{let a=e.map(e=>"<td>".concat(e,"</td>")).join("");for(let n=e.length;n<t;n++)a+="<td></td>";return"<tr>".concat(a,"</tr>")}}).join("");return a=(a=a.replaceAll(":selected:","✔️")).replaceAll(":unselected:","✖️"),'<table class="border">'.concat(a,"</table>")})},x=e=>{let t=r.Wp.book_new();e.forEach((e,a)=>{let n=r.Wp.aoa_to_sheet(e);r.Wp.book_append_sheet(t,n,"Sheet".concat(a+1))}),(0,r.$7)(t,"Pen2Print-Export.xlsx")};async function b(e,t){let a=m(e),l=a.map(e=>e.map(e=>(e=e.map(e=>'"'.concat(e.replace(/"/g,'""'),'"'))).join(",")).join("\n")),r=h(a);switch(t){case"CSV":return(0,s.saveAs)(new Blob([l],{type:"text/plain"}),"Pen2Print-Export.csv"),!0;case"EXCEL":return x(a),!0;case"WORD":{let e=r.join('<div class="page-break" style="page-break-after: always;"></div>');return await (0,n.A)(e).then(e=>((0,s.saveAs)(e,"Pen2Print-Export.docx"),!0)).catch(e=>(console.log("Error converting to Word",e),!1))}}return(0,s.saveAs)(new Blob([a],{type:"text/plain"}),"Pen2Print-Export.csv"),!0}},37938:(e,t,a)=>{"use strict";a.r(t),a.d(t,{__N_SSG:()=>T,default:()=>A});var n=a(74848);a(80243);var s=a(74450),l=a(13368),r=a.n(l),o=a(96540),c=a(96048),i=a(11700),d=a(71998),p=a(86715),g=a(24206),u=a(10159),m=a(29335),h=a(95704),x=a(83953);function b(e){let{...t}=e,a=(0,d.MW)(),s=(0,c.wA)(),{user:l}=(0,o.useContext)(m.t0),r=(0,o.useRef)({}),p=(0,o.useRef)(null);(0,o.useEffect)(()=>{(0,g.$)("View_TablesFileSelectView")},[]);let b=async(e,a)=>(l&&l.uid,e.type.toLowerCase().toLowerCase().endsWith("pdf"))?((0,g.$)("State_pdfFile"),console.log("Tables::Splitting pdf"),h.TablesPdf(t.lak,a.content)):((0,g.$)("State_imageFile"),console.log("Tables::Sending image"),h.TablesImage(t.lak,e));return(0,n.jsxs)("main",{className:"fileSelectView",children:[(0,n.jsxs)("div",{className:"blueCircles",children:[(0,n.jsx)("div",{className:"blueCircle1"}),(0,n.jsx)("div",{className:"blueCircle2"}),(0,n.jsx)("div",{className:"blueCircle3"})]}),u.Fr&&(0,n.jsx)("input",{ref:p,type:"file",style:{display:"none"},id:"input_file_obj",onChange:e=>{var t;null==r||null===(t=r.current)||void 0===t||t.onMobileFileChange(e.target.value)}}),(0,n.jsx)("div",{className:"pageHeadlines",children:(0,n.jsx)("h1",{children:" Digitize Tables & Forms"})}),(0,n.jsx)(x.e,{showInfoMsg:(e,t)=>a.info(e,t),onAnalyzePage:(e,t,a)=>{let n=e.content;return e.name.toLowerCase().endsWith(".pdf")&&(n="data:image/jpeg;base64,".concat(t.srcImg)),{service:"TABLES",name:e.name,width:e.width,height:e.height,html:t.html,tableData:t.tableData,scanId:e.id,scanIndex:a,content:n}},onAnalysisComplete:e=>{s((0,i.$9)(e))},preProcessFile:()=>!0,alert:a,processFileBlob:b,fileSelectMobileDiv:p,fileSelectRef:r})]})}var v=a(29679),w=a(97190),j=a(22405),f=a(39820),y=a(28165);a(14274),a(34811),a(35465);var N=a(51630),P=a(55281);let _=function(e){let{...t}=e,s=(0,c.wA)(),l=(0,d.MW)(),r=(0,p.useRouter)(),u=(0,c.d4)(e=>e.application.activeScan),h=(0,c.d4)(e=>e.application.activeScan.exportFormat),x=(0,c.d4)(e=>e.application.activeScan.pages),[b,_]=(0,o.useState)(0),{profile:E,signedIn:S,user:C,app:T,fingerPrintProfile:A}=(0,o.useContext)(m.t0),k=(0,j.aU)(T),[R,D]=(0,o.useState)(y.XQ.STATUS_ERROR),[F,I]=(0,o.useState)([]);(0,o.useEffect)(()=>{(0,g.$)("View_TablesScanLines")},[]),(0,o.useEffect)(()=>(r.beforePopState(e=>{let{as:t}=e;return s((0,i.HA)()),r.push(w.uq,void 0,{shallow:!0}),!0}),()=>{r.beforePopState(()=>!0)}),[r]),(0,o.useEffect)(()=>{D((0,v.Rq)(E,A,S,C,(null==x?void 0:x.length)||1,y.ne.DOC_AI))},[E,A,S,C,x]),(0,o.useEffect)(()=>{I(x)},[x]);let L=x.length,O=e=>{console.log("Selected value:",e),s((0,i.he)(e))},U=async()=>{(0,g.$)("Action_TablesDownloadPressed"),R===y.XQ.STATUS_OK?(console.log("Download pressed",h),(await Promise.resolve().then(a.bind(a,55281))).exportTables(x,h).then(e=>{if(e)l.info("Downloading");else{l.error("Error exporting file");return}S===f.iv?(0,m.MZ)(C,k,x.length||1,u.scanId,h,"DOC_AI"):(0,m.Hd)(A.profile.id,k,x.length||1,u.scanId,h)}),(0,g.$)("State_ExportingTables"),(0,g.$)("State_Export",{App:"Tables",Type:h,Format:"",Pages:x.length||1,signedIn:S})):R===y.XQ.STATUS_SUBSCRIPTION_REACHED_LIMIT?((0,g.$)("State_SubscriptionReachedLimit"),N.$Q(s,(0,n.jsxs)("p",{children:["Not enough pages left on your account. ",(0,n.jsx)("br",{}),"Upgrade your plan or wait for next month for additional credits."]}),"Upgrade Now",()=>{r.push(w.bP,void 0,{shallow:!0})})):R===y.XQ.STATUS_SERVICE_NOT_INCLUDED?((0,g.$)("State_ServiceNotIncluded"),N.$Q(s,(0,n.jsxs)("p",{children:["The tool you're trying to use is not included in your current plan. ",(0,n.jsx)("br",{}),"Consider upgrading your plan to access this tool."]}),"Upgrade Now",()=>{r.push(w.bP,void 0,{shallow:!0})})):((0,g.$)("State_NoCredit"),N.$Q(s,(0,n.jsxs)("p",{children:["Not enough pages left on your account. ",(0,n.jsx)("br",{}),"Get a plan for additional credits."]}),"Learn More",()=>{r.push(w.bP,void 0,{shallow:!0})}))},W=()=>{let e="";try{let e=(0,P.exportAllPagesToList)(x)[b],t=(0,P.splitPagesToHtml)([e]),a="<div>\n                    ".concat(t.join(""),"\n                </div>");return a=(a=(a=a.replaceAll(RegExp("<p>\\\\n<\\/p>","gs"),"<br/>")).replaceAll(":selected:","✔️")).replaceAll(":unselected:","✖️")}catch(t){console.log("Error:",t),e=t.message}return e},M=()=>{let e=W();return(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})};return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"scanLinesHeaderContainer",children:(0,n.jsx)("div",{className:"download-now",children:(0,n.jsxs)("div",{className:"exportButtonRow",children:[(0,n.jsxs)("div",{className:"downloadAsView",children:[(0,n.jsx)("div",{className:"exportNowLabel",children:"Download as"}),(0,n.jsxs)("form",{className:"export-format",action:"",children:[(0,n.jsx)("input",{type:"radio",id:"word",name:"format",value:"WORD",onChange:e=>{O(e.target.value)},checked:"WORD"===u.exportFormat}),(0,n.jsx)("label",{htmlFor:"word",children:"WORD"}),(0,n.jsx)("input",{type:"radio",id:"excel",name:"format",value:"EXCEL",onChange:e=>{O(e.target.value)},checked:"EXCEL"===u.exportFormat}),(0,n.jsx)("label",{htmlFor:"excel",children:"EXCEL"}),(0,n.jsx)("input",{type:"radio",id:"csv",name:"format",value:"CSV",onChange:e=>{O(e.target.value)},checked:"CSV"===u.exportFormat}),(0,n.jsx)("label",{htmlFor:"csv",children:"CSV"})]})]}),(0,n.jsx)("div",{className:"downloadButton",children:(0,n.jsxs)("button",{className:null===h?"convert-button-disabled":"convert-button",onClick:U,children:["Download",(0,n.jsx)("img",{className:"download-now-icon",src:"/Images/download_icon.png",alt:"download now"})]})})]})})}),(0,n.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center"},children:(0,n.jsxs)("div",{className:"scanline-linearea",children:[L>1?(0,n.jsxs)("div",{className:"page-navigation",children:[(0,n.jsx)("div",{className:"scanline-arrow",onClick:()=>{b>=1&&_(b-1)},children:b>=1?(0,n.jsx)("img",{src:"/Images/arrow_back_blue.png",alt:"previous page"}):(0,n.jsx)("img",{src:"/Images/arrow_back_gray.png",alt:"no previous page"})}),(0,n.jsxs)("div",{className:"page-counter",children:["Page ",b+1,"/",L]}),(0,n.jsx)("div",{className:"scanline-arrow",onClick:()=>{b<L-1&&_(b+1)},children:b<L-1?(0,n.jsx)("img",{src:"/Images/arrow_next_blue.png",alt:"next page"}):(0,n.jsx)("img",{src:"/Images/arrow_next_gray.png",alt:"no next page"})})]}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)("div",{className:"scanline-table",children:(()=>{let e=x[b];var t="";t=void 0!==e.content&&""!==e.content&&"data:image/png;base64,"!==e.content?e.content:URL.createObjectURL(e.srcImg);let a=M(e.tableData);return(0,n.jsxs)("div",{className:"scanLine-table-row",children:[(0,n.jsx)("div",{className:"scanline-table-image-cell",children:(0,n.jsx)("img",{className:"scanline-cell-image-content",src:t,alt:"scanned handwriting page"})}),(0,n.jsx)("div",{className:"scanline-table-image-cell",children:a})]})})()})]})})]})};var E=a(91106),S=a.n(E);let C=function(e){let t=(0,c.d4)(e=>e.application.activeScan.pages),a=(0,c.wA)(),{profile:s,signedIn:l,user:r,fingerPrintProfile:d}=(0,o.useContext)(m.t0),[p,g]=(0,o.useState)("-");(0,o.useEffect)(()=>{g(v.RH(s,d,l))},[l,s,d]);let u=(0,n.jsx)("div",{className:"sign-up-message",children:(0,n.jsxs)("p",{children:["Convert and download the first ",y.RT," pages for free!"]})}),h=(0,n.jsx)("div",{className:"sign-up-message",children:(0,n.jsxs)("p",{children:["Only ",p," pages left, for more pages",(0,n.jsx)(S(),{href:w.bP,children:(0,n.jsx)("button",{className:"cursorActive",children:"Get a plan now"})})]})}),x=(0,n.jsx)("div",{className:"sign-up-message",children:(0,n.jsxs)("p",{children:["No pages left, for more pages",(0,n.jsx)(S(),{href:w.bP,children:(0,n.jsx)("button",{className:"cursorActive",children:"Get a plan now"})})]})});return(0,n.jsxs)("div",{className:"MainWindow",children:[l===f.eS?p===y.RT?u:p<=0?x:!1===isNaN(p)?h:(0,n.jsx)(n.Fragment,{}):l===f.iv?p<=0?x:p<=y.RT?h:(0,n.jsx)(n.Fragment,{}):console.log("Login undef")&&(0,n.jsx)(n.Fragment,{}),t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(_,{...e}),(0,n.jsx)("div",{className:"notesButtonArea",children:(0,n.jsx)("button",{className:"startNewFormButton",onClick:()=>{console.log("startNewPressed"),a((0,i.HA)())},children:(0,n.jsx)("img",{src:"/Images/start_new.png",alt:"start new"})})})]}):(0,n.jsx)(b,{...e})]})};var T=!0;function A(e){let[t,a]=(0,o.useState)((0,n.jsx)(n.Fragment,{}));return(0,o.useEffect)(()=>{a((0,n.jsx)(s.A,{activePage:(0,n.jsx)(C,{...e})}))},[]),(0,n.jsxs)("div",{children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:"Pen to Print Searchable PDF Maker Online OCR"}),(0,n.jsx)("meta",{name:"description",content:"Convert scanned handwritten notes to PDF with online OCR and make your scans searchable.."}),(0,n.jsx)("meta",{property:"og:title",content:"Pen to Print's searchable PDF"}),(0,n.jsx)("meta",{property:"og:url",content:"https://www.pen-to-print.com/"}),(0,n.jsx)("meta",{property:"og:description",content:"Convert scanned handwritten image or pdf to digital text"}),(0,n.jsx)("meta",{property:"og:image",content:"https://s3.amazonaws.com/support.p2p.serendi.me/P2P_whatsapp.png"}),(0,n.jsx)("meta",{property:"og:image:width",content:"300"}),(0,n.jsx)("meta",{property:"og:image:height",content:"200"}),(0,n.jsx)("meta",{property:"og:image:type",content:"image/png"}),(0,n.jsx)("meta",{name:"robots",content:"max-image-preview:large"}),(0,n.jsx)("meta",{name:"robots",content:"noindex"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width,initial-scale=1"})]}),t]})}},34811:()=>{},70366:()=>{},2912:()=>{},14638:()=>{},49993:()=>{},61067:()=>{},54656:()=>{},81006:()=>{},83686:()=>{},32383:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[9883,8247,59,971,949,3200,7481,8777,9965,1106,8199,1024,864,3554,4450,9238,9860,636,6593,8792],()=>t(7174)),_N_E=e.O()}]);